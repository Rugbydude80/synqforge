try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="96bfd8f4-10b1-4d6c-9b75-7f096d0e24e8",e._sentryDebugIdIdentifier="sentry-dbid-96bfd8f4-10b1-4d6c-9b75-7f096d0e24e8")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9008],{25053:(e,s,t)=>{Promise.resolve().then(t.bind(t,70840))},70840:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>C});var r=t(95155),a=t(12115),l=t(36489),i=t(20063),n=t(89715),o=t(6191),c=t(86651),d=t(87717),h=t(95740),x=t(11010),m=t(71360),u=t(79397),p=t(97003),g=t(83209),j=t(67812),b=t(47507),f=t(33789),y=t(44022),v=t(46070),w=t(48371),N=t(25016),k=t(2327),S=t(18720);function A(){let{status:e}=(0,l.useSession)(),s=(0,i.useRouter)(),t=(0,i.useSearchParams)(),A=null==t?void 0:t.get("highlight"),[C,P]=a.useState([]),[E,I]=a.useState([]),[_,F]=a.useState([]),[M,T]=a.useState(!0),[L,$]=a.useState(""),[z,D]=a.useState(!1),[R,U]=a.useState(!1),[O,V]=a.useState(),[B,G]=a.useState(""),[H,W]=a.useState("all"),[Z,Y]=a.useState("all"),[q,J]=a.useState("all"),[K,Q]=a.useState("all"),[X,ee]=a.useState(""),[es,et]=a.useState(1),[er,ea]=a.useState(24),el=a.useMemo(()=>[...E].sort((e,s)=>e.name.localeCompare(s.name)),[E]),ei=a.useMemo(()=>[..."all"===Z?_:_.filter(e=>e.projectId===Z)].sort((e,s)=>e.title.localeCompare(s.title)),[_,Z]);a.useEffect(()=>{"all"!==q&&"none"!==q&&(ei.some(e=>e.id===q)||J("all"))},[ei,q]),a.useEffect(()=>{"all"!==Z&&(E.some(e=>e.id===Z)||Y("all"))},[E,Z]);let en=a.useCallback(async()=>{try{T(!0),$(""),F([]);let[e,s]=await Promise.all([fetch("/api/projects",{cache:"no-store",credentials:"include"}),fetch("/api/stories?limit=1000",{cache:"no-store",credentials:"include"})]);if(!e.ok)throw Error("Failed to load projects");if(!s.ok)throw Error("Failed to load stories");let t=await e.json(),r=await s.json(),a=Array.isArray(null==t?void 0:t.data)?t.data:[],l=Array.isArray(null==r?void 0:r.data)?r.data:[];if(I(a),P(l),a.length>0){let e=await Promise.all(a.map(async e=>{try{let s=await fetch("/api/projects/".concat(e.id,"/epics"),{cache:"no-store",credentials:"include"});if(!s.ok)throw Error("Failed to load epics");let t=await s.json();return Array.isArray(null==t?void 0:t.data)?t.data:[]}catch(s){return console.error("Failed to fetch epics for project ".concat(e.id,":"),s),[]}}));F(e.flat())}}catch(e){console.error("Failed to fetch data:",e),$(e.message||"Failed to load stories")}finally{T(!1)}},[]);a.useEffect(()=>{if("unauthenticated"===e)return void s.push("/auth/signin");"authenticated"===e&&en()},[e,s,en]);let eo=e=>e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),ec=async(e,s)=>{if(s.stopPropagation(),confirm("Are you sure you want to delete this story?"))try{await k.F.stories.delete(e),S.o.success("Story deleted successfully!"),en()}catch(e){S.o.error(e.message||"Failed to delete story")}},ed=()=>{en()};a.useEffect(()=>{A&&!M&&setTimeout(()=>{let e=document.getElementById("story-".concat(A));e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{let e=new URLSearchParams(window.location.search);e.delete("highlight"),s.replace("".concat(window.location.pathname).concat(e.toString()?"?"+e.toString():""),{scroll:!1})},3e3))},100)},[A,M,s]);let eh=a.useMemo(()=>{let e=X.trim().toLowerCase();return C.filter(s=>{var t,r;let a=0===e.length||s.title.toLowerCase().includes(e)||null!=(r=null==(t=s.description)?void 0:t.toLowerCase().includes(e))&&r,l="all"===H||s.status===H,i="all"===Z||s.projectId===Z,n="all"===q||"none"===q&&!s.epicId||s.epicId===q,o="all"===K||s.priority===K;return a&&l&&i&&n&&o})},[C,X,H,Z,q,K]);a.useEffect(()=>{et(1)},[X,H,Z,q,K]);let ex=eh.length,em=(es-1)*er,eu=eh.slice(em,em+er);return"loading"===e||M?(0,r.jsxs)("div",{className:"flex min-h-screen bg-background",children:[(0,r.jsx)(v.AppSidebar,{}),(0,r.jsx)("main",{className:"flex-1 md:ml-64",children:(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,r.jsx)("div",{className:"text-muted-foreground",children:"Loading stories..."})})})]}):(0,r.jsxs)("div",{className:"flex min-h-screen bg-background",children:[(0,r.jsx)(v.AppSidebar,{}),(0,r.jsxs)("main",{className:"flex-1 md:ml-64",children:[(0,r.jsx)("div",{className:"border-b border-gray-700 bg-gray-800/50 backdrop-blur-xl sticky top-0 z-10",children:(0,r.jsx)("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-4 md:py-6",children:(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[(0,r.jsx)("div",{className:"h-10 w-10 sm:h-12 sm:w-12 rounded-xl bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center shadow-lg shadow-purple-500/50",children:(0,r.jsx)(n.A,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-white",children:"All Stories"}),(0,r.jsx)("p",{className:"text-gray-400",children:"View and manage all your user stories across projects"})]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[(0,r.jsx)(p.$,{variant:"outline",size:"sm",onClick:en,disabled:M,children:"Refresh"}),(0,r.jsxs)(p.$,{size:"sm",onClick:()=>{var e;if(0===E.length){S.o.error("Please create a project first"),s.push("/projects");return}let t="all"!==Z?Z:null==(e=E[0])?void 0:e.id;if(!t)return void S.o.error("No project selected");G(t),V(void 0),D(!0)},className:"bg-gradient-to-r from-purple-500 to-pink-500 hover:from-purple-600 hover:to-pink-600",children:[(0,r.jsx)(o.A,{className:"h-4 w-4 mr-2"}),"New Story"]}),(0,r.jsxs)(j.E,{variant:"secondary",className:"text-sm",children:[eh.length," ",1===eh.length?"story":"stories"]})]})]})})}),(0,r.jsxs)("div",{className:"container mx-auto px-6 py-8",children:[(0,r.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(c.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,r.jsx)(f.p,{type:"text",placeholder:"Search stories by title or description...",value:X,onChange:e=>ee(e.target.value),className:"pl-10"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm text-gray-400 mb-2 block",children:"Status"}),(0,r.jsxs)(b.l,{value:H,onChange:e=>W(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"All Status"}),(0,r.jsx)("option",{value:"backlog",children:"Backlog"}),(0,r.jsx)("option",{value:"ready",children:"Ready"}),(0,r.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,r.jsx)("option",{value:"review",children:"Review"}),(0,r.jsx)("option",{value:"done",children:"Done"}),(0,r.jsx)("option",{value:"blocked",children:"Blocked"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm text-gray-400 mb-2 block",children:"Project"}),(0,r.jsxs)(b.l,{value:Z,onChange:e=>Y(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"All Projects"}),el.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.key,")"]},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm text-gray-400 mb-2 block",children:"Epic"}),(0,r.jsxs)(b.l,{value:q,onChange:e=>J(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"All Epics"}),(0,r.jsx)("option",{value:"none",children:"No Epic"}),ei.map(e=>(0,r.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm text-gray-400 mb-2 block",children:"Priority"}),(0,r.jsxs)(b.l,{value:K,onChange:e=>Q(e.target.value),children:[(0,r.jsx)("option",{value:"all",children:"All Priorities"}),(0,r.jsx)("option",{value:"low",children:"Low"}),(0,r.jsx)("option",{value:"medium",children:"Medium"}),(0,r.jsx)("option",{value:"high",children:"High"}),(0,r.jsx)("option",{value:"critical",children:"Critical"})]})]})]})]}),L&&(0,r.jsxs)("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 px-4 py-3 rounded-lg mb-6 flex items-center justify-between gap-4 flex-wrap",children:[(0,r.jsx)("span",{children:L}),(0,r.jsx)(p.$,{variant:"outline",size:"sm",onClick:en,children:"Try again"})]}),0===eh.length?(0,r.jsx)(g.Zp,{className:"bg-gray-800/50 border-gray-700",children:(0,r.jsxs)(g.Wu,{className:"flex flex-col items-center justify-center py-16",children:[(0,r.jsx)("div",{className:"h-16 w-16 rounded-full bg-purple-500/10 flex items-center justify-center mb-4",children:(0,r.jsx)(n.A,{className:"h-8 w-8 text-purple-400"})}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:0===C.length?"No Stories Yet":"No Stories Match Filters"}),(0,r.jsx)("p",{className:"text-gray-400 text-center max-w-md mb-6",children:0===C.length?"Create your first story in a project or use AI to generate stories.":"Try adjusting your filter criteria to see more results."}),0===C.length&&(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)(p.$,{onClick:()=>s.push("/projects"),children:[(0,r.jsx)(d.A,{className:"h-4 w-4 mr-2"}),"Go to Projects"]}),(0,r.jsxs)(p.$,{variant:"outline",onClick:()=>s.push("/ai-generate"),children:[(0,r.jsx)(h.A,{className:"h-4 w-4 mr-2"}),"AI Generate"]})]})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:eu.map(e=>{let t,a,l;return(0,r.jsx)(g.Zp,{id:"story-".concat(e.id),className:(0,N.cn)("bg-gray-800/50 border-gray-700 hover:border-purple-500/50 hover:shadow-lg hover:shadow-purple-500/10 transition-all cursor-pointer group",A===e.id&&"ring-2 ring-purple-500 border-purple-500 animate-pulse"),onClick:()=>s.push("/stories/".concat(e.id)),children:(0,r.jsxs)(g.Wu,{className:"p-5",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[e.priority&&(0,r.jsx)(j.E,{className:(0,N.cn)("text-xs border",(e=>{switch(e){case"critical":return"bg-red-500/10 text-red-400 border-red-500/20";case"high":return"bg-orange-500/10 text-orange-400 border-orange-500/20";case"medium":return"bg-yellow-500/10 text-yellow-400 border-yellow-500/20";case"low":return"bg-green-500/10 text-green-400 border-green-500/20";default:return"bg-gray-500/10 text-gray-400 border-gray-500/20"}})(e.priority)),children:(t=e.priority)?eo(t):"Unspecified"}),(0,r.jsx)(j.E,{className:(0,N.cn)("text-xs border",(e=>{switch(e){case"done":return"bg-emerald-500/10 text-emerald-400 border-emerald-500/20";case"in_progress":return"bg-purple-500/10 text-purple-400 border-purple-500/20";case"review":return"bg-amber-500/10 text-amber-400 border-amber-500/20";case"ready":return"bg-blue-500/10 text-blue-400 border-blue-500/20";case"blocked":return"bg-red-500/10 text-red-400 border-red-500/20";default:return"bg-gray-500/10 text-gray-400 border-gray-500/20"}})(e.status)),children:(a=e.status)?eo(a):"Unknown"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[e.aiGenerated&&(0,r.jsx)(h.A,{className:"h-4 w-4 text-purple-400 flex-shrink-0"}),(0,r.jsxs)("div",{className:"hidden group-hover:flex items-center gap-1",children:[(0,r.jsx)(p.$,{size:"sm",variant:"ghost",onClick:s=>{s.stopPropagation(),V(e),G(e.projectId),U(!0)},className:"h-7 w-7 p-0",children:(0,r.jsx)(x.A,{className:"h-3.5 w-3.5"})}),(0,r.jsx)(p.$,{size:"sm",variant:"ghost",onClick:s=>ec(e.id,s),className:"h-7 w-7 p-0 text-red-400 hover:text-red-300 hover:bg-red-400/10",children:(0,r.jsx)(m.A,{className:"h-3.5 w-3.5"})})]})]})]}),(0,r.jsx)("h3",{className:"font-semibold text-white mb-2 line-clamp-2 group-hover:text-purple-400 transition-colors",children:e.title}),e.description&&(0,r.jsx)("p",{className:"text-sm text-gray-400 line-clamp-2 mb-3",children:e.description}),(0,r.jsxs)("div",{className:"space-y-2 mb-3",children:[e.project&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)(d.A,{className:"h-3 w-3 text-gray-500"}),(0,r.jsxs)("span",{className:"text-gray-400",children:[e.project.name," (",e.project.key,")"]})]}),e.epic&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)(u.A,{className:"h-3 w-3 text-gray-500"}),(0,r.jsx)("span",{className:"text-gray-400",children:e.epic.title})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-500 pt-3 border-t border-gray-700",children:[e.storyPoints&&(0,r.jsxs)("span",{className:"font-mono",children:[e.storyPoints," pts"]}),(0,r.jsx)("span",{children:(l=e.storyType)?eo(l):"Unknown"})]})]})},e.id)})}),eh.length>0&&(0,r.jsx)("div",{className:"mt-8",children:(0,r.jsx)(y.d,{currentPage:es,totalItems:ex,itemsPerPage:er,onPageChange:e=>{et(e),window.scrollTo({top:0,behavior:"smooth"})},onItemsPerPageChange:e=>{ea(e),et(1)},itemName:"stories"})})]})]})]}),z&&(0,r.jsx)(w.F,{open:z,onOpenChange:D,projectId:B,onSuccess:ed}),R&&O&&(0,r.jsx)(w.F,{open:R,onOpenChange:U,projectId:B,story:O,onSuccess:ed})]})}function C(){return(0,r.jsx)(a.Suspense,{fallback:(0,r.jsxs)("div",{className:"flex min-h-screen bg-background",children:[(0,r.jsx)(v.AppSidebar,{}),(0,r.jsx)("main",{className:"flex-1 ml-64",children:(0,r.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,r.jsx)("div",{className:"text-muted-foreground",children:"Loading stories..."})})})]}),children:(0,r.jsx)(A,{})})}},71360:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(71847).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])}},e=>{e.O(0,[5707,6489,8720,9484,8184,5193,4650,6077,575,4964,2164,4850,8441,504,7358],()=>e(e.s=25053)),_N_E=e.O()}]);