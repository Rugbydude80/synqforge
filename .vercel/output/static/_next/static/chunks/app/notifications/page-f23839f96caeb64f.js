try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="458df6d4-b80a-4f97-9cb6-8325e3ac0b2b",e._sentryDebugIdIdentifier="sentry-dbid-458df6d4-b80a-4f97-9cb6-8325e3ac0b2b")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6173],{1746:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>N});var s=a(95155),r=a(12115),l=a(20063),i=a(96583),n=a(37586),d=a(95740),c=a(6132);let o=(0,a(71847).A)("check-check",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var m=a(85998),u=a(97003),h=a(83209),x=a(46070),p=a(68122),f=a(25016),y=a(53298),b=a(18720);let g={story_assigned:i.A,comment_mention:n.A,comment_reply:n.A,sprint_starting:d.A,story_blocked:c.A,epic_completed:o},j={story_assigned:"text-blue-400",comment_mention:"text-purple-400",comment_reply:"text-purple-400",sprint_starting:"text-yellow-400",story_blocked:"text-red-400",epic_completed:"text-green-400"};function N(){let e=(0,l.useRouter)(),[t,a]=r.useState([]),[i,n]=r.useState(!0),[d,c]=r.useState("all");r.useEffect(()=>{N()},[]);let N=async()=>{try{n(!0);let e=await fetch("/api/notifications");if(!e.ok)throw Error("Failed to fetch");let t=await e.json();a(t)}catch(e){console.error("Failed to fetch notifications:",e),b.o.error("Failed to load notifications")}finally{n(!1)}},v=async e=>{try{if(!(await fetch("/api/notifications/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({read:!0})})).ok)throw Error("Failed to mark as read");a(t.map(t=>t.id===e?{...t,read:!0}:t))}catch(e){b.o.error("Failed to mark as read")}},w=async()=>{try{let e=t.filter(e=>!e.read).map(e=>e.id);await Promise.all(e.map(e=>fetch("/api/notifications/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({read:!0})}))),a(t.map(e=>({...e,read:!0}))),b.o.success("All notifications marked as read")}catch(e){b.o.error("Failed to mark all as read")}},k=async t=>{t.read||await v(t.id),t.actionUrl&&e.push(t.actionUrl)},A=r.useMemo(()=>"unread"===d?t.filter(e=>!e.read):t,[t,d]),_=t.filter(e=>!e.read).length,D=r.useMemo(()=>{let e={};return A.forEach(t=>{let a,s=new Date(t.createdAt),r=new Date,l=new Date(r);l.setDate(l.getDate()-1),e[a=s.toDateString()===r.toDateString()?"Today":s.toDateString()===l.toDateString()?"Yesterday":s.toLocaleDateString("en-US",{month:"long",day:"numeric",year:s.getFullYear()!==r.getFullYear()?"numeric":void 0})]||(e[a]=[]),e[a].push(t)}),e},[A]);return(0,s.jsxs)("div",{className:"flex min-h-screen bg-background",children:[(0,s.jsx)(x.AppSidebar,{}),(0,s.jsxs)("main",{className:"flex-1 ml-64",children:[(0,s.jsx)("div",{className:"border-b border-border bg-card/80 backdrop-blur-xl sticky top-0 z-10",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-8 py-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-gradient-primary",children:(0,s.jsx)(m.A,{className:"h-6 w-6 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"Notifications"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:_>0?"".concat(_," unread"):"All caught up"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(u.$,{variant:"all"===d?"default":"ghost",size:"sm",onClick:()=>c("all"),children:"All"}),(0,s.jsx)(u.$,{variant:"unread"===d?"default":"ghost",size:"sm",onClick:()=>c("unread"),children:"Unread"}),_>0&&(0,s.jsxs)(u.$,{variant:"outline",size:"sm",onClick:w,children:[(0,s.jsx)(o,{className:"h-4 w-4 mr-2"}),"Mark all read"]})]})]})})}),(0,s.jsx)("div",{className:"max-w-4xl mx-auto px-8 py-8",children:i?(0,s.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,s.jsx)(h.Zp,{children:(0,s.jsxs)(h.Wu,{className:"p-4 flex items-start gap-4",children:[(0,s.jsx)(p.E,{className:"h-10 w-10 rounded-full"}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)(p.E,{className:"h-4 w-3/4"}),(0,s.jsx)(p.E,{className:"h-3 w-1/2"})]})]})},t))}):0===Object.keys(D).length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)(m.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No notifications"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"unread"===d?"All caught up! No unread notifications.":"You don't have any notifications yet."})]}):(0,s.jsx)("div",{className:"space-y-6",children:Object.entries(D).map(e=>{let[t,a]=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-sm font-semibold text-muted-foreground mb-3",children:t}),(0,s.jsx)("div",{className:"space-y-2",children:a.map(e=>{let t=g[e.type]||m.A,a=j[e.type]||"text-muted-foreground";return(0,s.jsx)(h.Zp,{className:(0,f.cn)("cursor-pointer hover:border-purple-500/50 transition-colors",!e.read&&"bg-purple-500/5 border-purple-500/20"),onClick:()=>k(e),children:(0,s.jsxs)(h.Wu,{className:"p-4 flex items-start gap-4",children:[(0,s.jsx)("div",{className:(0,f.cn)("p-2 rounded-full bg-muted",a),children:(0,s.jsx)(t,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium mb-1",children:e.message}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,y.m)(new Date(e.createdAt),{addSuffix:!0})})]}),!e.read&&(0,s.jsx)("div",{className:"h-2 w-2 rounded-full bg-purple-500 flex-shrink-0 mt-2"})]})},e.id)})})]},t)})})})]})]})}},37586:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]])},58461:(e,t,a)=>{Promise.resolve().then(a.bind(a,1746))},68122:(e,t,a)=>{"use strict";a.d(t,{E:()=>l});var s=a(95155),r=a(25016);function l(e){let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,r.cn)("animate-pulse rounded-md bg-muted",t),...a})}},85998:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(71847).A)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]])}},e=>{e.O(0,[5707,6489,8720,9484,6434,3298,1097,4850,8441,504,7358],()=>e(e.s=58461)),_N_E=e.O()}]);