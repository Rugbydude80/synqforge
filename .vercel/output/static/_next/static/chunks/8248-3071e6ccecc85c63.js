try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="f8d8eee6-1195-4673-9f96-7d8b7f6a4606",e._sentryDebugIdIdentifier="sentry-dbid-f8d8eee6-1195-4673-9f96-7d8b7f6a4606")}()}catch(e){}"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8248],{45010:(e,s,t)=>{t.d(s,{u:()=>n});var a=t(95155),r=t(12115),i=t(33789),l=t(67812),o=t(65229),d=t(25016);function n(e){let{value:s,onChange:t,placeholder:n="Add tag...",disabled:c,className:u}=e,[h,p]=r.useState("");return(0,a.jsxs)("div",{className:(0,d.cn)("space-y-2",u),children:[s.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:s.map(e=>(0,a.jsxs)(l.E,{variant:"secondary",className:"gap-1 pr-1",children:[(0,a.jsx)("span",{children:e}),(0,a.jsx)("button",{type:"button",onClick:()=>{t(s.filter(s=>s!==e))},disabled:c,className:"rounded-full hover:bg-muted-foreground/20 p-0.5 transition-colors","aria-label":"Remove ".concat(e," tag"),children:(0,a.jsx)(o.A,{className:"h-3 w-3"})})]},e))}),(0,a.jsx)(i.p,{value:h,onChange:e=>p(e.target.value),onKeyDown:e=>{if("Enter"===e.key&&h.trim()){e.preventDefault();let a=h.trim();s.includes(a)||t([...s,a]),p("")}else"Backspace"===e.key&&!h&&s.length>0&&t(s.slice(0,-1))},placeholder:0===s.length?n:"Add another...",disabled:c,className:"text-sm"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Press Enter to add tags"})]})}},48248:(e,s,t)=>{t.d(s,{G:()=>m});var a=t(95155),r=t(12115),i=t(54679),l=t(97003),o=t(33789),d=t(67001),n=t(90235),c=t(47507),u=t(49264),h=t(45010),p=t(18720);function m(e){var s,t;let{open:m,onOpenChange:g,storyId:x,projectId:v,task:y,onSuccess:j}=e,[f,b]=r.useState({title:(null==y?void 0:y.title)||"",description:(null==y?void 0:y.description)||"",status:(null==y?void 0:y.status)||"todo",priority:(null==y?void 0:y.priority)||"medium",estimatedHours:(null==y||null==(s=y.estimatedHours)?void 0:s.toString())||"",actualHours:(null==y||null==(t=y.actualHours)?void 0:t.toString())||"",assigneeId:(null==y?void 0:y.assigneeId)||"",tags:(null==y?void 0:y.tags)||[],storyId:x||(null==y?void 0:y.storyId)||""}),[N,k]=r.useState(!1),[I,H]=r.useState([]),[w,C]=r.useState(!1),[S,F]=r.useState(null);r.useEffect(()=>{m&&v&&!x&&(async()=>{C(!0),F(null);try{let e=await fetch("/api/projects/".concat(v,"/stories"),{credentials:"include"});if(e.ok){let s=await e.json();console.log("Fetched stories:",s),Array.isArray(null==s?void 0:s.data)?(H(s.data),0===s.data.length&&F("No stories found in this project. Please create a story first.")):(H([]),F("Unexpected response format from server"))}else{let s=await e.json().catch(()=>({error:"Failed to fetch stories"}));F(s.error||"Error: ".concat(e.status," ").concat(e.statusText)),console.error("Failed to fetch stories:",e.status,s)}}catch(e){console.error("Failed to fetch stories:",e),F("Network error: Unable to fetch stories")}finally{C(!1)}})()},[m,v,x]),r.useEffect(()=>{if(y){var e,s;b({title:y.title,description:y.description||"",status:y.status,priority:y.priority,estimatedHours:(null==(e=y.estimatedHours)?void 0:e.toString())||"",actualHours:(null==(s=y.actualHours)?void 0:s.toString())||"",assigneeId:y.assigneeId||"",tags:y.tags||[],storyId:y.storyId})}else b({title:"",description:"",status:"todo",priority:"medium",estimatedHours:"",actualHours:"",assigneeId:"",tags:[],storyId:x||""})},[y,m,x]);let T=async e=>{if(e.preventDefault(),!f.title.trim())return void p.o.error("Please enter a task title");if(!y&&!f.storyId)return void p.o.error("Please select a story");k(!0);try{let e={title:f.title,description:f.description||void 0,status:f.status,priority:f.priority,assigneeId:f.assigneeId||null,tags:f.tags.length>0?f.tags:void 0};f.estimatedHours&&(e.estimatedHours=parseInt(f.estimatedHours,10)),f.actualHours&&(e.actualHours=parseInt(f.actualHours,10)),y||(e.storyId=f.storyId,e.projectId=v);let s=y?"/api/tasks/".concat(y.id):"/api/tasks",t=y?"PUT":"POST",a=await fetch(s,{method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();throw Error(e.message||"Failed to save task")}j()}catch(e){p.o.error(e.message||"Failed to save task")}finally{k(!1)}};return(0,a.jsx)(i.lG,{open:m,onOpenChange:g,children:(0,a.jsxs)(i.Cf,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)(i.c7,{children:[(0,a.jsx)(i.L3,{children:y?"Edit Task":"Create Task"}),(0,a.jsx)(i.rr,{children:y?"Update the task details below.":"Break down your story into smaller, manageable tasks."})]}),(0,a.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[!y&&!x&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(n.J,{htmlFor:"story",children:["Story ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsxs)(c.l,{id:"story",value:f.storyId,onChange:e=>b({...f,storyId:e.target.value}),disabled:w||0===I.length,required:!0,children:[(0,a.jsx)("option",{value:"",children:"Select a story..."}),I.map(e=>(0,a.jsx)("option",{value:e.id,children:e.title},e.id))]}),w&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading stories..."}),S&&(0,a.jsxs)("div",{className:"rounded-lg bg-destructive/10 border border-destructive/20 p-3",children:[(0,a.jsx)("p",{className:"text-sm text-destructive font-medium",children:S}),S.includes("No stories found")&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"\uD83D\uDCA1 Tip: Go to your project and create a story first, then come back to create tasks."})]}),!w&&!S&&0===I.length&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"No stories available"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(n.J,{htmlFor:"title",children:["Title ",(0,a.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,a.jsx)(o.p,{id:"title",value:f.title,onChange:e=>b({...f,title:e.target.value}),placeholder:"What needs to be done?",required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"description",children:"Description"}),(0,a.jsx)(d.T,{id:"description",value:f.description,onChange:e=>b({...f,description:e.target.value}),placeholder:"Add more details about this task...",rows:4})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"status",children:"Status"}),(0,a.jsxs)(c.l,{id:"status",value:f.status,onChange:e=>b({...f,status:e.target.value}),children:[(0,a.jsx)("option",{value:"todo",children:"To Do"}),(0,a.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,a.jsx)("option",{value:"done",children:"Done"}),(0,a.jsx)("option",{value:"blocked",children:"Blocked"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"priority",children:"Priority"}),(0,a.jsxs)(c.l,{id:"priority",value:f.priority,onChange:e=>b({...f,priority:e.target.value}),children:[(0,a.jsx)("option",{value:"low",children:"Low"}),(0,a.jsx)("option",{value:"medium",children:"Medium"}),(0,a.jsx)("option",{value:"high",children:"High"}),(0,a.jsx)("option",{value:"critical",children:"Critical"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"estimatedHours",children:"Estimated Hours"}),(0,a.jsx)(o.p,{id:"estimatedHours",type:"number",min:"0",step:"0.5",value:f.estimatedHours,onChange:e=>b({...f,estimatedHours:e.target.value}),placeholder:"0"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"actualHours",children:"Actual Hours"}),(0,a.jsx)(o.p,{id:"actualHours",type:"number",min:"0",step:"0.5",value:f.actualHours,onChange:e=>b({...f,actualHours:e.target.value}),placeholder:"0"})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{htmlFor:"assignee",children:"Assignee"}),(0,a.jsx)(u.o,{value:f.assigneeId,onChange:e=>b({...f,assigneeId:e||""}),placeholder:"Assign to..."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(n.J,{children:"Tags"}),(0,a.jsx)(h.u,{value:f.tags,onChange:e=>b({...f,tags:e}),placeholder:"Add tags..."})]}),(0,a.jsxs)(i.Es,{children:[(0,a.jsx)(l.$,{type:"button",variant:"outline",onClick:()=>g(!1),disabled:N,children:"Cancel"}),(0,a.jsx)(l.$,{type:"submit",disabled:N||!y&&!x&&0===I.length,children:N?"Saving...":y?"Update Task":"Create Task"})]})]})]})})}},49264:(e,s,t)=>{t.d(s,{o:()=>o});var a=t(95155),r=t(12115),i=t(47507),l=t(2327);function o(e){let{value:s,onChange:t,placeholder:o="Select user",disabled:d}=e,[n,c]=r.useState([]),[u,h]=r.useState(!0);r.useEffect(()=>{p()},[]);let p=async()=>{try{h(!0);let e=await l.F.users.list();c(e.data||[])}catch(e){console.error("Failed to fetch users:",e),c([])}finally{h(!1)}};return u?(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Loading users..."}):(0,a.jsxs)(i.l,{value:s||"",onChange:e=>t(e.target.value||void 0),disabled:d,className:"text-sm",children:[(0,a.jsx)("option",{value:"",children:o}),n.map(e=>(0,a.jsx)("option",{value:e.id,children:e.name||e.email},e.id))]})}}}]);